https://cpp-dev.eu-central-1.aws.cloud.bmw/cpp/

ForeverOmideeMitzLuna
QXZ3VN8
QXZ3VNA
&An0th3rLongSalt3dHa5h

user id: C090917 C090917 Magg, Bernhard	4FP2 Vendor VIEW_ONLY
	 Q091034 Kuempfbeck, Alexandra CA-402 Packaging Planning Parts BMW_ADMINISTRATOR
7 digit BMW part number: 0031435

C692671
C098110  Heyer Thomas

Q105419 Danke Andrea D000556050
Vendor:
0000618893 - ALPINE STARS
Organizational Unit:
DGF1

https://cpp-dev.eu-central-1.aws.cloud.bmw/cpp/pages/administration/batchSchedule.xhtml
https://cpp-dev.eu-central-1.aws.cloud.bmw/cpp/pages/workflow/assignBmwCode.xhtml
https://cpp-dev.eu-central-1.aws.cloud.bmw/cpp/pages/workflow/assignVendorCode.xhtml
https://cpp-dev.eu-central-1.aws.cloud.bmw/cpp/pages/workflow/createProposalBMW.xhtml

&ltscript&gtalert(1)&lt/script&gt

Bernhard' or '1'='1' --

=cmd|’/Ccalc.exe’!z

Vulnerabilities

1). Failure to Invalidate Session on Logout   => MEDIUM
2). Cookie "Expires" Flag Missconfiguration   => MEDIUM
3). Missing Security Headers                  => MEDIUM
4). Missing SameSite Cookie Flag              => INFO
5). Missing Input Validation                  => LOW
6). Forced browsing                           => HIGH 

Cookie "Expires" Flag Missconfiguration
ce tine de user session trebuie trecut ca session iar ce tine de user preferences () language, color, site theme

Improper Logout Mechanism

Vulnerability Category: A5-Broken Access Control
expires trebuie setat pe session nu pe time in server-side. totodata time trebuie setat pe maxim 1 ora

The cookies are stored in Session Storage Cookies. After Logout the app must invalidate the session cookie. If the old cookies are used the app loggedin and the session is restored.

cURL request to replicate. plase advice to change the cookie value from the below example
curl -i -s -k -X $'GET' \
    -H $'Host: cpp-dev.eu-central-1.aws.cloud.bmw' \
    -b $'AWSELBAuthSessionCookie-0=oQeVdADTMQ/Jv5My2nXlJXhIUPwBPw/n4iXFj0E4mVsptGuFGVKubPK2hM8UagXLD3zdMtgaI2EaqxOv8lJISEylwxRBvTtmoVy4KZgxIB0XB//RLIBBQxOHF9zdNgYlaM4EK167yf+cTaVC0KA1W/A/K9XQ8VWhhj1/DkfBvcLdgkQFz8GvkVZwhVGWMQhgRyyulDM4kkc2y5lS/1JjPDd9D7C9CAZM0W7hY2mMhYqSNFBgq8hpPGJV/GT/VXHt+U6nZzt0RewfbMcq5nE9dCZc5rEAUi9oDWj9r0ykjI0YduW+yeZnzx9+RgQzOBFxHgZayn1IG8IAeca3K0FP4TNGUBqgpVyu2CwvoExWtF8Ssw1z18in1GCiYMDoUMpXfdF1qivERsuL2Ro6FWkfD' \
    $'https://cpp-dev.eu-central-1.aws.cloud.bmw/cpp/pages/home.xhtml'

Missing SameSite Header

Desi Sec-Fetch-Site header este implementat si setat pe same-origin, datorita posibilitatii de bypass este recomandata utilizarea unui nou layer de securitate prin SameSite.
